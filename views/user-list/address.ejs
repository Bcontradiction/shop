<div class="container views-userlist-collect">
    <!--导航-->
    <div class="user-collect vi-co-title">
        <ul class="nav aw-nav-tabs active">
            <h4>
                <i class="fa fa-heart" aria-hidden="true"></i>&nbsp;编辑收货地址
            </h4>
        </ul>
    </div>
    <ul class="vi-co-list">
        <% url.forEach(function(urls){%>
        <li class="v-c-l-li-address">
            <h5>收货人信息:</h5>
            <div class="flort-left clearfix thislidiv">
                <p>收货人: <a href=""><%= urls.name %></a></p>
                <p>地址: <a href=""><%= urls.url %></a></p>
                <p>手机(固定电话): <a href=""><%= urls.tel %></a></p>
            </div>
            <div class="v-c-l-l-a-btn flort-right clearfix">
                <div class="click-shop-buy v-c-l-l-btn-pub v-c-l-l-btn-add flort-left clearfix">
                    <span><a href="#" class="click-url-default" target="<%= urls._id %>">设置为默认</a></span>
                </div>
                <div class="click-shop-buy v-c-l-l-btn-pub v-c-l-l-btn-add flort-left click-url-edit
                clearfix" data-toggle="modal" data-target="#modalEdit" target="<%= urls._id %>">
                    <span><a href="#">编辑</a></span>
                </div>
                <div class="click-shop-buy v-c-l-l-btn-pub v-c-l-l-btn-add flort-left click-url-deleted
                clearfix" data-toggle="modal" data-target="#modalDelete" target="<%= urls._id %>">
                    <span><a href="#">删除</a></span>
                </div>
            </div>
            <!-- 编辑 -->
            <div class="modal fade" id="modalEdit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
                 ng-app="editUrlApp" ng-controller="editUrlController" style="margin: 0 auto">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                &times;
                            </button>
                            <h4 class="modal-title" id="myModalLabel">
                                填写收货人具体信息
                            </h4>
                        </div>
                        <div class="modal-body">
                            <form id="search-form" class="form-horizontal" name="editUrlForm" ng-submit="postForm()">
                                <!--姓名-->
                                <div class="form-group">
                                    <label for="name" class="col-sm-2 control-label">收货人:</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control editUrlname" id="search-name" name="name" autocomplete="off"
                                               ng-model="formData.name"
                                               required value="formData.name">
                                    </div>

                                    <div style="height:20px;">
                                    <span ng-cloak ng-show="editUrlForm.name.$invalid && !editUrlForm.name.$pristine" class="text-danger">
                                        请输入正确的姓名
                                    </span>
                                        <span ng-show="editUrlForm.name.$error.required" class="text-danger">收货人是必须填写的。</span>
                                    </div>
                                </div>
                                <!--收货地址-->
                                <div class="form-group">
                                    <label for="text" class="col-sm-2 control-label">收货地址:</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control editUrlurl" id="search-name" name="url" autocomplete="off"
                                               ng-model="formData.url"
                                               required value="">
                                    </div>

                                    <div style="height:20px;">
                                    <span ng-cloak ng-show="editUrlForm.url.$invalid && !editUrlForm.url.$pristine" class="text-danger">
                                        请输入正确的地址
                                    </span>
                                        <span ng-show="editUrlForm.url.$error.required" class="text-danger">地址也是必须填写的。</span>
                                    </div>
                                </div>
                                <!--手机号-->
                                <div class="form-group">
                                    <label for="tel" class="col-sm-2 control-label">手机号码(固定电话):</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control editUrltel" id="search-tel" name="tel"
                                               ng-model="formData.tel"
                                               ng-pattern="/^1[1-9|1-9][0-9]\d{4,8}$/" required value="">
                                    </div>

                                    <div style="height:20px;">
                                    <span ng-cloak ng-show="editUrlForm.tel.$invalid && !editUrlForm.tel.$pristine" class="text-danger">
                                        请输入正确的联系方式
                                    </span>
                                        <span ng-show="editUrlForm.tel.$error.required" class="text-danger">手机或者固定电话得选择其中一个填写</span>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <input type="text" class="editurlsubmitinput hide" value="">
                                    <button type="button"  class="btn btn-default"  data-dismiss="modal">重置
                                    </button>
                                    <button type="submit" ng-disabled="editUrlForm.$invalid" class="btn btn-primary editurlsubmit">
                                        提交
                                    </button>
                                </div>

                            </form>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal -->
            </div>
        </li>

        <%})%>
        <li class="center" style="margin-left: 25%;height: 50px;line-height: 50px">
            <div class="click-shop-buy v-c-l-l-btn-pub v-c-l-l-btn-add flort-left
            clearfix" data-toggle="modal" data-target="#myModal">
                <span><a href="#">新增</a></span>
            </div>
        </li>

        <!--新增收货地址-->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
             ng-app="addUrlApp" ng-controller="addUrlController">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h4 class="modal-title" id="myModalLabel">
                            添加一个新的收货地址
                        </h4>
                    </div>
                    <div class="modal-body">
                        <form id="search-form" class="form-horizontal" name="addUrlForm" ng-submit="postForm()">
                            <!--姓名-->
                            <div class="form-group">
                                <label for="name" class="col-sm-2 control-label">收货人:</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="search-name" name="name" autocomplete="off"
                                           ng-model="formData.name"
                                           required>
                                </div>

                                <div style="height:20px;">
                                    <span ng-cloak ng-show="addUrlForm.name.$invalid && !addUrlForm.name.$pristine" class="text-danger">
                                        请输入正确的姓名
                                    </span>
                                    <span ng-show="addUrlForm.name.$error.required" class="text-danger">收货人是必须填写的。</span>
                                </div>
                            </div>
                            <!--收货地址-->
                            <div class="form-group">
                                <label for="text" class="col-sm-2 control-label">收货地址:</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="search-name" name="url" autocomplete="off"
                                           ng-model="formData.url"
                                           required>
                                </div>

                                <div style="height:20px;">
                                    <span ng-cloak ng-show="addUrlForm.url.$invalid && !addUrlForm.url.$pristine" class="text-danger">
                                        请输入正确的地址
                                    </span>
                                    <span ng-show="addUrlForm.url.$error.required" class="text-danger">地址也是必须填写的。</span>
                                </div>
                            </div>
                            <!--手机号-->
                            <div class="form-group">
                                <label for="tel" class="col-sm-2 control-label">手机号码:</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="search-tel" name="tel"
                                           ng-model="formData.tel"
                                           ng-pattern="/^1[1-9|1-9][0-9]\d{4,8}$/" required>
                                </div>

                                <div style="height:20px;">
                                    <span ng-cloak ng-show="addUrlForm.tel.$invalid && !addUrlForm.tel.$pristine" class="text-danger">
                                        请输入正确的联系方式
                                    </span>
                                    <span ng-show="addUrlForm.tel.$error.required" class="text-danger">手机号码不能为空</span>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" id="resetData" class="btn btn-default" ng-click="resetData()" data-dismiss="modal">重置
                                </button>
                                <button type="submit" ng-disabled="addUrlForm.$invalid" class="btn btn-primary">
                                    确认新增
                                </button>
                            </div>
                        </form>
                    </div>

                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </div>

    </ul>
</div>
<script>
   /* $("#myModal").on("hidden", function() {
        $(this).removeData("modal");
    });*/
    //删除操作
    $('.click-url-deleted').click(function(event){
//        console.log(1561)
        var id = $(this).attr('target')
//        console.log(id)

        $.ajax({
            type:'POST',
            url:`/address/${id}/delete/`,
            headers:{'Content-Type':'application/x-www-form-urlencoded'}
        }).done(function(data){
            console.log(data)
            if(data.success){
                alert(data.message);
            }
        })
    })

</script>